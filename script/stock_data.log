/opt/notebookdir/GP/script/stock_data.py:171: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  stock_sh_a_spot_em_dfs=pd.read_sql("select * from now_gp_price",con=conn)
100
爬取截至时间: 2025-10-31
2024-10-31 15:30:03.942053
2400
0 0.7296322060420165
1 0.8067553717898125
2 0.6491217825644179
3 0.18590582238474562
4 0.9161616161087334
5 0.5222293721049996
6 0.6619249747867223
7 0.712947976200468
8 0.5254033428556681
9 0.7862528195448307
10 0.7050922443377877
11 0.5708363295421677
12 0.7725205606503219
13 0.24267461909734622
14 0.12629219290880567
15 0.18826949140311333
16 0.4003182304082493
17 0.6951104389016565
18 0.09488028143709215
19 0.6923395177131265
20 0.817363599792352
21 0.45320037112000766
22 0.11079808104226041
23 0.4572842622046348
24 0.29191526273556156
25 0.023093929878007846
26 0.10012937604804695
27 0.23104421621008653
28 0.3266369778204148
29 0.8781621920190953
30 0.6270037430971224
31 0.4484359327263585
32 0.829451828608533
33 0.5736758749329868
34 0.6966048737763246
35 0.646189242779401
36 0.32170752095459365
37 0.2671881542230219
38 0.10655889229185367
39 0.5063361833605441
40 0.08365750046079368
41 0.5252882743796877
42 0.981830793586527
43 0.5907742417758388
44 0.47835644752224904
45 0.2792051736755319
46 0.00159296459404501
47 0.6716723438118382
48 0.31766291913101696
49 0.23776502131068622
50 0.7699837722558865
51 0.9600085913134379
52 0.27190061351834616
53 0.9330092648823745
54 0.10206165292864944
55 0.7189183244906387
56 0.6484510526796917
57 0.44890670692062407
58 0.11152030739237029
59 0.328243683481519
60 0.7924385637142094
61 0.1705905761749097
62 0.5134563024460818
63 0.4887881513886364
64 0.6375568360312214
65 0.7618617935778583
66 0.8283033698419694
67 0.8120824670656427
68 0.7211785322936424
69 0.6209301737752182
70 0.5841051897899407
71 0.33785539012277366
72 0.08536808654242889
73 0.5092160882396386
74 0.3065774950299084
75 0.3074369116560697
76 0.36254808254704507
77 0.19572044415598921
78 0.09278528218134063
79 0.13788220902094817
80 0.9695337086563547
81 0.43859475455493413
82 0.3207373544399871
83 0.7085025636550096
84 0.24965400310044084
85 0.43752448668785504
86 0.2399031187148205
87 0.6190332367535458
88 0.19812866046072364
89 0.6447640414435956
90 0.01603682130977524
91 0.28617027427872344
92 0.5947978048363706
93 0.6989691449708789
94 0.7691376893411795
95 0.4391220786957344
96 0.3784350894829469
97 0.7462855786841038
98 0.74889013465799
99 0.08032971012899259
100 0.07621867720563369
101 0.7105985360622001
102 0.12951368844319278
103 0.2892770865362799
104 0.36766723139794477
105 0.8412914597682373
106 0.7373777143487904
107 0.2979772738687382
108 0.17374935962035065
109 0.9057263830023914
110 0.5904332169579318
111 0.1818886724008001
112 0.05332032554000621
113 0.781309769699666
114 0.7698383859171043
115 0.48364226702934865
116 0.3425161655849923
117 0.6304159739116626
118 0.8936680337998273
119 0.6109112821465819
120 0.18927076973685586
121 0.7076334933667812
122 0.005925752245118376
123 0.5670450477140977
124 0.6477755643446623
125 0.10124827970827
126 0.06240020431093496
127 0.9097359531407739
128 0.6681647811195239
129 0.06384977596876074
130 0.7314486725389436
131 0.7113515226213043
132 0.21332893978389056
133 0.15372214697510644
134 0.43861242312281257
135 0.22421929538915586
136 0.9448590679875113
137 0.23720567112760682
138 0.4925180420292343
139 0.5699957962402096
140 0.8118701922109961
141 0.3341857992567776
142 0.9402452777195295
143 0.5493094848231692
144 0.9552184354413461
145 0.8441616750809532
146 0.8542094056727746
147 0.32353872514695103
148 0.8541257089409316
149 0.6644684291164945
150 0.6698124799400034
151 0.303209346647611
152 0.6069894537352482
153 0.7863865031980258
154 0.331952534468976
155 0.17573352980852985
156 0.7646219460980619
157 0.5804629127767761
158 0.4182656561528687
159 0.608313689206876
160 0.8790875006444808
161 0.8063367994117169
162 0.8410967077309521
163 0.8868792554235126
164 0.30392763346015617
165 0.8903758904160293
166 0.4030216028613044
167 0.708123663079036
168 0.9615519376802778
169 0.617705562430513
170 0.15112309813179126
171 0.8405536425781819
172 0.729732813846168
173 0.5916394960312592
174 0.5863214819952137
175 0.9045786916298909
176 0.37780221544745607
177 0.6009830748071395
178 0.934864277932388
179 0.6141479959104427
180 0.987750388486291
181 0.1827498950125005
182 0.03919857539572036
183 0.6661512284080681
184 0.2833491364837831
185 0.8262669451714458
186 0.32257039744457316
187 0.3480708837345535
188 0.04393277753068814
189 0.06175176054440756
190 0.3417545573712689
191 0.9633591117367464
192 0.5956466028110138
Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py", line 449, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py", line 444, in _make_request
    httplib_response = conn.getresponse()
  File "/opt/miniconda3/lib/python3.9/http/client.py", line 1377, in getresponse
    response.begin()
  File "/opt/miniconda3/lib/python3.9/http/client.py", line 320, in begin
    version, status, reason = self._read_status()
  File "/opt/miniconda3/lib/python3.9/http/client.py", line 289, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.9/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/util/retry.py", line 550, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/packages/six.py", line 769, in reraise
    raise value.with_traceback(tb)
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py", line 449, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py", line 444, in _make_request
    httplib_response = conn.getresponse()
  File "/opt/miniconda3/lib/python3.9/http/client.py", line 1377, in getresponse
    response.begin()
  File "/opt/miniconda3/lib/python3.9/http/client.py", line 320, in begin
    version, status, reason = self._read_status()
  File "/opt/miniconda3/lib/python3.9/http/client.py", line 289, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/notebookdir/GP/script/stock_data.py", line 185, in <module>
    stock_zh_a_hist_df = ak.stock_zh_a_hist(
  File "/opt/miniconda3/lib/python3.9/site-packages/akshare/stock_feature/stock_hist_em.py", line 927, in stock_zh_a_hist
    r = requests.get(url, params=params, timeout=timeout)
  File "/opt/miniconda3/lib/python3.9/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/opt/miniconda3/lib/python3.9/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/opt/miniconda3/lib/python3.9/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/miniconda3/lib/python3.9/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/miniconda3/lib/python3.9/site-packages/requests/adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
